# Linux文件与目录管理

## 1.目录与路径
- 常用的目录操作
	- cd：切换目录
	- pwd：显示当前目录
	- mkdir：新建一个目录
	- rmdir：删除一个空目录
- 执行文件路径变量：$PATH
	- 当执行一个命令时，系统会按照 PATH 的设置去其定义的目录下查询命令对应的可执行文件。
	- 多个目录下有与命令相同的文件时，按照先被查询的目录下的文件执行。

## 2.文件与目录管理
- 查看文件与目录：ls
```
[root@www~]# ls [参数] [目录名称]

# 常用参数：
# -a：全部文件，包括隐藏文件
# -d：仅列出目录本身，而非目录内文件数据
# -l：列出长数据串，包含文件属性与权限等数据
```
- 复制文件或目录：cp
```
[root@www~]# cp [参数] 源文件 目标文件

# 常用参数：
# -a：相当于 -pdr
# -i：若目标文件已经存在，覆盖时会先询问操作的进行
# -p：连同文件的属性一起复制过去，而非使用默认属性。常用于备份
# -d：若源文件为链接文件，则复制链接文件的属性而非实际文件本身
# -r：递归持续复制，常用于目录的复制行为
```

默认条件下，cp 的源文件与目的文件的权限是不同的，目的文件的所有者通常是命令操作者本身。因此，在进行备份时，一些需特别注意的特别权限文件如密码文件等，不能直接用 cp 来复制，而必须要加上 -a 或者是 -p 等可以完整复制文件权限的参数。

- 删除文件或目录：rm
```
[root@www~]# rm [参数] 文件

# 常用参数：
# -f：强制模式，忽略不存在的文件，不会出现警告信息
# -i：互动模式，删除前询问用户是否操作
# -r：递归删除，特别危险的参数（古往今来多少数据死于rm -rf）
```

- 移动文件或目录：mv
```
[root@www~]# mv [参数] 源文件 目标文件
[root@www~]# mv [参数] 源文件1 源文件2 ... 目标目录

# 常用参数：
# -f：强制模式，若目标文件已经存在则不会询问，强行覆盖。
# -i：互动模式。
# -u：更新模式，若目标文件已经存在，且源文件比目标文件要新，才会更新。
```

- 取得路径的文件名与目录名称：basename 与 dirname

## 3.文件内容查阅

直接查阅文件内容：

- cat：从第一行开始显示文件内容
	- 参数 -b：打印行号，但空白行不标行号
	- 参数 -n：显示结尾断行字符 $ 
	- 参数 -T：将 Tab 按键以 ^I 显示出来
- tac：从最后一行开始倒序显示文件内容
- nl：显示时输出行号

翻页查看：

- more：向后一页一页翻动
- less：既可向后、也可向前一页一页翻动

数据选取：

- head：取出前面几行，`# head [-n number] 文件名`，其中 number 为显示行数
- tail：取出后面几行，`# head [-n number] 文件名`，其中 number 为显示行数

查阅非纯文本文件：

- od：读取数据文件。`# od [-t TYPE] 文件`
	- 参数 TYPE 为 a：使用默认的字符来输出
	- 参数 TYPE 为 c：使用 ASCII 方式来输出

其他操作：

- touch：修改文件时间或创建新文件
- file：查看文件类型

## 4.文件与目录的默认权限与隐藏权限
### 文件默认权限：umask
即**当前用户**在新建文件或目录时的权限默认设置值。
```
[root@www ~]# umask 
0022   #与一般权限有关的是后面三个数字 
[root@www ~]# umask -S 
u=rwx,g=rx,o=rx  #以符号形式显示
[root@www ~]# umask 002 
# 设置 unmask 值为002

```
在原始默认权限的属性上，目录与文件是不一样的：

- 若用户创建文件则默认没有 x 权限，默认权限为：-rw-rw-rw-
- 若用户新建目录，由于 x 权限与是否可以进入此目录有关，因此默认所有权限开放，即：drwxrwxrwx

注意的是，umask 的分数是指 “默认值**再**需要减去的权限”。因此当 umask 分数是022时，则用户新建文件的权限是 -rw-r--r--；新建目录的权限是 drwxr-xr-x 。

### 文件隐藏属性

文件的隐藏属性主要用于系统安全方面。

- chattr：设置文件的隐藏属性
```
[root@www ~]# chattr [+-=] [参数] 文件或目录名

# 参数：
# +：增加某个特殊参数，其他已存在参数不动
# -：删除某个特殊参数，其他已存在参数不动
# =：仅有后面接的参数

# a：让该文件只能增加数据，而不能删除与修改数据（主要用于日志文件）。只有root可设置本权限。
# i：让该文件不可被删除、改名、设置链接、增写数据（无敌状态）。只有root可设置本权限。
```

- lsattr：显示文件的隐藏属性
```
[root@www ~]# lsattr [参数] 文件或目录名

# 参数：
# -a：列出隐藏文件
# -d：若接的是目录，则仅列出目录本身属性
# -R：连同子目录的数据也列出来
```

### 文件特殊权限：SUID、SGID、SBIT
- 文件具有SUID的特殊权限时，代表当使用者运行此 binary 程序时，在运行过程中使用者会暂时具有程序拥有者的权限，权限数字为4
- 目录具有SGID的特殊权限时，代表使用者在这个目录底下新建的文件之群组都会与该目录的群组名称相同，权限数字为2
- 目录具有SBIT的特殊权限时，代表在该目录下使用者创建的文件只有自己与root能够删除，权限数字为1

## 5.命令与文件的查询
### 脚本文件名的查询
- which：寻找“执行文件”
```
[root@www ~]# which [-a] command
# 参数
# -a：列出所有可以从PATH路径找到的同名执行文件
```
### 文件名的查找
- whereis（寻找特定文件）
```
[root@www ~]# whereis [-bmsu] 文件或目录
# 参数
# -b：只找二进制格式的文件
# -m：只找在说明文件manual路径下的文件
# -s：只找source源文件
# -u：查找不在上述三个选项中的其他特殊文件 
```

- locate（关键字查找文件）
须安装 mlocate 方可使用。
```
[root@www ~]# locate [-ir] keyword
# 参数
# -i：忽略大小写差异
# -r：后面可接正则表达式的显示方式
```

- find（功能最强的查询）
```
[root@www ~]# find [PATH] [option] [action]

# 1.与时间有关的参数：共有 -atime、-ctime 和 -mtime
# -mtime n ： n 为数字，表示在 n 天之前的“一天之内”被更改过的文件
# -mtime +n ：列出在 n 天之前(不含 n 天本身)被更动过的文件
# -mtime -n ：列出在 n 天之内(含 n 天本身)被更动过的文件
# -newer file ：file 为一个存在的文件，列出比 file 还要新的文件

# 2.与用户或用户组有关的参数：
# -user name ：name 为用户名。例如 dmtsai
# -group name ：name 为用户组，例如 users 

# 3.与文件权限及名称有关的参数：
# -name filename：查找文件名为 filename 的文件
# -size [+-]SIZE：查找比 SIZE 还要大(+)或小(-)的文件，如“-size +50k”
# -type TYPE：查找文件类型为 TYPE 的文件，包括：一般文件(f)、目录(d)、链接文件(l)
# -perm mode：查找文件权限刚好等于 mode 的文件                
```

